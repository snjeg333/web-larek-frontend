# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/styles/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```
## Данные и типы данных, используемые в приложении

Карточка товара

```
export interface IProductItem {
	id: string;
	title: string;
	category: string;
	description: string;
	image: string;
	price: number;
}
```

Модель приложения

```
export interface IAppState {
	catalog: IProductItem[];
	basket: string[];
	preview: string | null;
	order: IOrder | null;
}
```

Форма заказа

```
export interface IOrderForm {
	payment: string;
	email: string;
	phone: string;
	address: string;
	total: number;
	items: string[];
}
```

Форма полного заказа

```
export interface IOrder extends IOrderForm {
	items: string[];
}
```

## Архитектура приложения

Код приложения разделен на слои согласно парадигме MVP: 
- Слой отображения (View) —  для взаимодействия с пользователем.
- Слой представления (Presenter) — соединяет отображение, данные и коммуникацию.
- Слой данных (Model) — содержит значительную часть бизнес-логики.

### Базовый код

#### Класс Api
Содержит в себе базовую логику отправки запросов. В конструктор передается базовый адрес сервера и опциональный объект с заголовками запросов.
Методы: 
- `get` - выполняет GET запрос на переданный в параметрах ендпоинт и возвращает промис с объектом, которым ответил сервер
- `post` - принимает объект с данными, которые будут переданы в JSON в теле запроса, и отправляет эти данные на ендпоинт переданный как параметр при вызове метода. По умолчанию выполняется `POST` запрос, но метод запроса может быть переопределен заданием третьего параметра при вызове.

#### Класс EventEmitter
Брокер событий позволяет отправлять события и подписываться на события, происходящие в системе. Класс используется в презентере для обработки событий и в слоях приложения для генерации событий.  
Основные методы, реализуемые классом описаны интерфейсом `IEvents`:
- `on` - подписка на событие
- `off` - снимает обработчик с события
- `emit` - инициализация события
- `trigger` - возвращает функцию, при вызове которой инициализируется требуемое в параметрах событие   

### Слой данных

#### Класс AppState
Содержит состояние корзины, заказа, каталога и ошибок валидации

В полях класса хранятся следующие данные:
- basket - хранилище товаров, добавленных в корзину
- catalog - хранилище всех товаров, полученых с сервера
- order - хранилище всех данных, сформированных для отправки заявки заказа
- preview - хранилище данных для превью
- formErrors - хранилище ошибок валидации

Так же класс предоставляет набор методов для взаимодействия с этими данными.
- setCatalog - добавляет данные товара в поле каталога
- setBasket - добавляет данные товара в поле корзины
- removeBasket - удаляет выбранный товар из корзины
- clearBasket - очищает корзину
- getTotal - считает общую сумму товаров
- setPreview - добавляет данные товара id в поле preview
- validateOrder - проверка ошибок валидации
- setOrderField - устанавливает данные в поле заказа

### Классы представления
Все классы представления отвечают за отображение внутри контейнера (DOM-элемент) передаваемых в них данных.

#### Класс Basket
Выводит на страницу контент корзины в модальном окне

Поля  являются HTML элементами:
- "list" - список товаров в корзине
- "total" - итоговая сумма заказа
- "button" - кнопка оформления заказа
Методы:
- set items - сеттер, добавляющий список всех элементов, добавленных в корзину
- set selected - сеттер, позволяющий блокировать/разблокировать кнопку оформления 
- set total - сеттер, позволяющий установить итоговую сумму всех товаров в корзине

#### Класс Form
Преднозначен для форм приложения

Поля класса являются HTML элементами:
- "submit" - кнопка подтверждения формы
- "errors" - элемент вывода ошибок валидации
Методы:
- onInputChange - выводит ошибку в разметку
- set valid - сеттер, позволяющий блокировать/разблокировать кнопку подтверждения
- set errors - сеттер, утсанавливаюший текст ошибки
- render - вызывает родительский метод

#### Класс Card
Класс предназначен для вывода товара на страницу

Поля класса являются HTML элементами:
- title - заголовок 
- price - стоимость 
- button - кнопка 

Методы:
- set id - сеттер, устанавливающий id карточки
- set title - сеттер, устанавливающий заголовок карточки
- set price - сеттер, устанавливающий стоимость карточки

#### Класс Modal 
Отвечает за работу модальных окон и вывод в них контента;

Поля класса являются HTML элементами:
- "closeButton" - кнопка закрытия модального окна
- "content" - элкмент с контентом
Методы:
- open - открытие модального окна
- close - закрытие модального окна
- render - вызывает родительский метод и отрисовывает модальное окно

#### Класс Success
Предназначен для отображения окна с уведомлением об успешном  выполнении заказа;

Поля класса являются HTML элементами:
- "description" - содержит текст с итоговой стоимостью заказа
- "close" - кнопка закрытия окна
Методы:
- "set description" - сеттер, устанавливающий текст с итоговой стоимостью заказа

#### Класс Order
Отрисовывает форму выбора способа оплаты и добавления места доставки

Поля класса являются HTML элементами:
- payment - кнопки со способами оплаты
- address - ввод адреса
- button - кнопка Далее

Методы:
- "set address" - сеттер, устанавливаюший адрес доставки
- "unActiveButton" - делает кнопки выдбора способа оплаты неактивными
- "getActiveButton" - возвращает активную кнопку

#### Класс Contacts
Отрисовывает форму заполнения контактных данных.

Поля класса являются HTML элементами:
- "button" - кнопка Оплатить
Методы:
- set phone - сеттер, устанавливающий номер телефона
- set email - сеттер, устанавливающий адрес электронной почты

#### Класс Page
Предназначен для вывода основных данных на страницу;

Поля класса являются HTML элементами:
- "counter" - счетчик количества товаров в корзине
- "catalog" - контейнер галереи товаров
- "wrapper" - основной контейнер всей страницы
- "basket" - кнопка корзины
Методы:
- "set counter" - сеттер, позволяющий установить значение добавленных карточек в счетчик корзины
- "set catalog" - сеттер, позволяющий добавить карточки товаров в контейнер
- "set locked" - сеттер, позволяющий блокировать прокрутку страницы если открыта модалка;